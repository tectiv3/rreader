import{x as L,o as j,g as s,h as e,i as C,m as g,R as w,t as o,k as u,j as S,l as F,v as z,F as V,p as T,a as n,E as A,c as l,s as U}from"./app-ClRdnNOD.js";import{u as D}from"./useSidebarStore-ysoHxPmv.js";import{u as I}from"./useToast-y8ji9q_N.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";const G={class:"mx-auto max-w-lg px-4 py-6"},H={class:"rounded-xl bg-neutral-50 dark:bg-neutral-900 p-5"},J={key:0,class:"mt-2"},K={class:"text-sm text-red-400"},O=["disabled"],P={key:0,class:"mr-2 h-4 w-4 animate-spin",viewBox:"0 0 24 24",fill:"none"},Q={key:0,class:"mt-5 rounded-xl bg-neutral-50 dark:bg-neutral-900 p-5"},W={class:"flex items-start gap-3 mb-4"},X=["src"],Y={class:"min-w-0 flex-1"},Z={class:"text-base font-medium text-neutral-900 dark:text-neutral-100 truncate"},$={key:0,class:"mt-1 text-sm text-neutral-500 dark:text-neutral-400 line-clamp-2"},ee={class:"mt-1 text-xs text-neutral-600 dark:text-neutral-500"},te={class:"mb-4"},se=["placeholder"],le={class:"mb-4"},ae={key:0},re=["value"],oe={key:1},ne={key:2,class:"mt-2"},ue={class:"text-sm text-red-400"},ie={key:3,class:"mt-2"},de={class:"text-sm text-red-400"},ce={key:0,class:"mb-3"},be={class:"text-sm text-red-400"},pe=["disabled"],ve={key:0,class:"mr-2 h-4 w-4 animate-spin",viewBox:"0 0 24 24",fill:"none"},fe={__name:"FeedCreateView",setup(me){const v=D(),h=L(),{error:_}=I(),y=n(""),f=n({}),b=n(!1),a=n(null),k=n(""),m=n(""),x=n(""),i=n({}),p=n(!1),c=n(!1),M=A(()=>v.categories);j(async()=>{if(!v.loaded)try{await v.fetchSidebar()}catch{}});async function B(){b.value=!0,f.value={},a.value=null;try{const d=await U.post("/api/feeds/preview",{url:y.value});a.value=d.data.preview}catch(d){d.response?.status===422?f.value=d.response.data.errors||{}:_(d.response?.data?.message||"Failed to discover feed")}finally{b.value=!1}}async function E(){if(!a.value)return;p.value=!0,i.value={};const d={feed_url:a.value.feed_url,title:k.value||a.value.title,category_id:c.value?"":m.value,new_category:c.value?x.value:""};try{await U.post("/api/feeds",d),await v.fetchSidebar(),h.push({name:"articles.index"})}catch(t){t.response?.status===422?i.value=t.response.data.errors||{}:_(t.response?.data?.message||"Failed to subscribe")}finally{p.value=!1}}function N(){c.value=!c.value,c.value?m.value="":x.value=""}function R(){window.history.length>1?h.back():h.push({name:"articles.index"})}return(d,t)=>(l(),s(V,null,[e("header",{class:"sticky top-0 z-30 border-b border-neutral-200 dark:border-neutral-800 bg-white/95 dark:bg-neutral-900/95 backdrop-blur supports-[backdrop-filter]:bg-white/80 dark:supports-[backdrop-filter]:bg-neutral-900/80 pt-safe"},[e("div",{class:"flex h-11 items-center justify-between px-4"},[e("div",{class:"flex items-center gap-2 min-w-0"},[e("button",{onClick:R,class:"rounded-lg p-2 text-neutral-500 dark:text-neutral-400 hover:bg-neutral-200 dark:hover:bg-neutral-800 hover:text-neutral-800 dark:hover:text-neutral-200 transition-colors -ml-2","aria-label":"Go back"},[...t[5]||(t[5]=[e("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"})],-1)])]),t[6]||(t[6]=e("h1",{class:"text-base font-semibold text-neutral-800 dark:text-neutral-200 truncate"}," Add Feed ",-1))])])]),e("div",G,[e("div",H,[t[9]||(t[9]=e("h2",{class:"text-base font-medium text-neutral-800 dark:text-neutral-200 mb-4"}," Feed URL ",-1)),e("form",{onSubmit:C(B,["prevent"])},[e("div",null,[g(e("input",{id:"url",type:"url",class:"block w-full text-base rounded-md border-neutral-700 bg-neutral-800 text-neutral-100 shadow-sm focus:border-blue-500 focus:ring-blue-500 placeholder-neutral-400","onUpdate:modelValue":t[0]||(t[0]=r=>y.value=r),placeholder:"https://example.com or feed URL",required:"",autofocus:""},null,512),[[w,y.value]]),t[7]||(t[7]=e("p",{class:"mt-1.5 text-xs text-neutral-600 dark:text-neutral-500"}," Enter a website URL or direct RSS/Atom feed URL ",-1)),f.value.url?(l(),s("div",J,[e("p",K,o(f.value.url[0]),1)])):u("",!0)]),e("button",{type:"submit",class:S(["mt-4 w-full inline-flex items-center justify-center rounded-md border border-transparent bg-blue-600 px-4 py-3 text-sm font-semibold uppercase tracking-widest text-white transition duration-150 ease-in-out hover:bg-blue-500 focus:bg-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-neutral-900 active:bg-blue-700",{"opacity-25":b.value}]),disabled:b.value},[b.value?(l(),s("svg",P,[...t[8]||(t[8]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"},null,-1)])])):u("",!0),F(" "+o(b.value?"Searching...":"Find Feed"),1)],10,O)],32)]),a.value?(l(),s("div",Q,[e("div",W,[a.value.favicon_url?(l(),s("img",{key:0,src:a.value.favicon_url,class:"mt-0.5 h-6 w-6 rounded",onError:t[1]||(t[1]=r=>r.target.style.display="none")},null,40,X)):u("",!0),e("div",Y,[e("h3",Z,o(a.value.title||"Untitled Feed"),1),a.value.description?(l(),s("p",$,o(a.value.description),1)):u("",!0),e("p",ee,o(a.value.article_count)+" articles found ",1)])]),e("form",{onSubmit:C(E,["prevent"])},[e("div",te,[t[10]||(t[10]=e("label",{for:"title",class:"block text-sm font-medium text-neutral-300"}," Title (optional) ",-1)),g(e("input",{id:"title",type:"text",class:"mt-1 block w-full text-base rounded-md border-neutral-700 bg-neutral-800 text-neutral-100 shadow-sm focus:border-blue-500 focus:ring-blue-500 placeholder-neutral-400","onUpdate:modelValue":t[2]||(t[2]=r=>k.value=r),placeholder:a.value.title||"Feed title"},null,8,se),[[w,k.value]])]),e("div",le,[t[12]||(t[12]=e("label",{for:"category",class:"block text-sm font-medium text-neutral-300"}," Category (optional) ",-1)),c.value?(l(),s("div",oe,[g(e("input",{id:"new_category",type:"text",class:"mt-1 block w-full text-base rounded-md border-neutral-700 bg-neutral-800 text-neutral-100 shadow-sm focus:border-blue-500 focus:ring-blue-500 placeholder-neutral-400","onUpdate:modelValue":t[4]||(t[4]=r=>x.value=r),placeholder:"New category name"},null,512),[[w,x.value]])])):(l(),s("div",ae,[g(e("select",{id:"category","onUpdate:modelValue":t[3]||(t[3]=r=>m.value=r),class:"mt-1 block w-full rounded-lg border-neutral-300 bg-white text-base text-neutral-800 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-neutral-700 dark:bg-neutral-800 dark:text-neutral-100"},[t[11]||(t[11]=e("option",{value:""},"No category",-1)),(l(!0),s(V,null,T(M.value,r=>(l(),s("option",{key:r.id,value:r.id},o(r.name),9,re))),128))],512),[[z,m.value]])])),e("button",{type:"button",onClick:N,class:"mt-2 text-sm text-blue-400 hover:text-blue-300"},o(c.value?"Choose existing category":"+ Create new category"),1),i.value.category_id?(l(),s("div",ne,[e("p",ue,o(i.value.category_id[0]),1)])):u("",!0),i.value.new_category?(l(),s("div",ie,[e("p",de,o(i.value.new_category[0]),1)])):u("",!0)]),i.value.feed_url?(l(),s("div",ce,[e("p",be,o(i.value.feed_url[0]),1)])):u("",!0),e("button",{type:"submit",class:S(["w-full inline-flex items-center justify-center rounded-md border border-transparent bg-blue-600 px-4 py-3 text-sm font-semibold uppercase tracking-widest text-white transition duration-150 ease-in-out hover:bg-blue-500 focus:bg-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-neutral-900 active:bg-blue-700",{"opacity-25":p.value}]),disabled:p.value},[p.value?(l(),s("svg",ve,[...t[13]||(t[13]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"},null,-1)])])):u("",!0),F(" "+o(p.value?"Subscribing...":"Subscribe"),1)],10,pe)],32)])):u("",!0)])],64))}},ke=q(fe,[["__scopeId","data-v-ec2a9fb1"]]);export{ke as default};
