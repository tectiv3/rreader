import{x as F,y as Y,w as G,o as O,b as W,g as n,h as a,j as K,k as l,l as f,t as p,F as E,i as J,a as i,C as x,c as o}from"./app-CNjV5YtX.js";import{u as Q}from"./useArticleStore-CYHdVFbe.js";import{u as Z}from"./useToast-rkUx_UMM.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";const te={class:"sticky top-0 z-30 border-b border-neutral-200 dark:border-neutral-800 bg-white/95 dark:bg-neutral-900/95 backdrop-blur supports-[backdrop-filter]:bg-white/80 dark:supports-[backdrop-filter]:bg-neutral-900/80 pt-safe"},re={class:"flex h-11 items-center justify-between px-4"},ae={class:"flex items-center gap-1 shrink-0"},ne=["aria-label"],oe=["fill"],le={key:0,class:"absolute right-0 top-full mt-1 w-48 rounded-lg border border-neutral-200 dark:border-neutral-700 bg-white dark:bg-neutral-800 shadow-lg py-1 z-50"},se={key:0,class:"flex items-center justify-center py-20"},ue={key:1,class:"overflow-x-hidden"},ie={class:"mb-6"},de={class:"text-2xl font-bold leading-tight text-neutral-900 dark:text-neutral-100"},ce=["href"],ve={class:"mt-3 flex flex-wrap items-center gap-x-3 gap-y-1 text-sm text-neutral-500 dark:text-neutral-400"},pe=["src"],ke={key:1},fe=["src","alt"],me=["innerHTML"],he={key:1,class:"py-12 text-center"},xe={class:"mt-8 flex items-center justify-between border-t border-neutral-200 dark:border-neutral-800 pt-4"},ge={key:1},be={key:3},B=80,I=30,we={__name:"ArticleDetailView",setup(ye){const d=Q(),k=F(),g=Y(),{success:b}=Z(),t=i(null),w=i(!0),u=i(!1),c=i(!1),y=i(null),_=i(null),m=i(!1);async function M(r){w.value=!0,t.value=null;try{const e=await d.fetchContent(Number(r));t.value=e,u.value=e.is_read_later??!1,d.markRead(Number(r)),d.prefetchAdjacent(Number(r))}catch{k.replace({name:"articles.index"})}finally{w.value=!1}}M(g.params.id),G(()=>g.params.id,r=>{r&&g.name==="articles.show"&&(m.value=!1,M(r))});const h=x(()=>t.value?d.adjacentIds(t.value.id):{prev:null,next:null});function v(r){if(m.value)return;const e=r==="next"?h.value.next:h.value.prev;e&&(m.value=!0,sessionStorage.setItem("article-swipe-direction",r),k.replace({name:"articles.show",params:{id:e}}))}const z=x(()=>t.value?.image_url?!(t.value.content||t.value.summary||"").includes(t.value.image_url):!1),N=x(()=>t.value?new Date(t.value.published_at).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""),V=x(()=>t.value?new Date(t.value.published_at).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}):"");function C(){window.history.length>1?k.back():k.push({name:"articles.index"})}function D(){t.value&&(d.toggleReadLater(t.value.id),u.value=!u.value,b(u.value?"Article saved":"Removed from Read Later"))}function H(){t.value&&(c.value=!1,d.markUnread(t.value.id),b("Marked as unread"))}function L(){if(t.value?.url){c.value=!1;try{const r=new URL(t.value.url);(r.protocol==="http:"||r.protocol==="https:")&&window.open(r.href,"_blank","noopener,noreferrer")}catch{}}}function U(){t.value&&(navigator.share?navigator.share({title:t.value.title,url:t.value.url}).catch(()=>{}):t.value.url&&navigator.clipboard.writeText(t.value.url).then(()=>{b("Link copied to clipboard")}).catch(()=>{}))}function X(){c.value=!c.value}function S(r){y.value&&!y.value.contains(r.target)&&(c.value=!1)}function A(r){r.target.tagName==="INPUT"||r.target.tagName==="TEXTAREA"||r.target.isContentEditable||(r.key==="ArrowRight"||r.key==="j"?v("next"):r.key==="ArrowLeft"||r.key==="k"?v("prev"):r.key==="Escape"&&C())}O(()=>{document.addEventListener("click",S),document.addEventListener("keydown",A);const r=sessionStorage.getItem("article-swipe-direction");if(r&&_.value){sessionStorage.removeItem("article-swipe-direction");const e=_.value,s=r==="next"?"40%":"-40%";e.style.transition="none",e.style.transform=`translateX(${s})`,e.offsetHeight,e.style.transition="transform 160ms ease-out",e.style.transform="translateX(0)",e.addEventListener("transitionend",()=>{e.style.transition="",e.style.transform=""},{once:!0})}}),W(()=>{document.removeEventListener("click",S),document.removeEventListener("keydown",A)});let R=0,T=0;function P(r){R=r.touches[0].clientX,T=r.touches[0].clientY}function $(r){if(m.value)return;const e=r.changedTouches[0].clientX-R,s=r.changedTouches[0].clientY-T,j=Math.abs(Math.atan2(s,e)*180/Math.PI);j>I&&j<180-I||(e<-B?v("next"):e>B&&v("prev"))}function q(r){k.push({name:"articles.index",query:{feed_id:r}})}return(r,e)=>(o(),n(E,null,[a("header",te,[a("div",re,[a("div",{class:"flex items-center gap-2 min-w-0"},[a("button",{onClick:C,class:"rounded-lg p-2 text-neutral-500 dark:text-neutral-400 hover:bg-neutral-200 dark:hover:bg-neutral-800 hover:text-neutral-800 dark:hover:text-neutral-200 transition-colors -ml-2","aria-label":"Go back"},[...e[5]||(e[5]=[a("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"})],-1)])])]),a("div",ae,[t.value?(o(),n("button",{key:0,onClick:D,class:K(["rounded-lg p-2 transition-colors cursor-pointer",u.value?"text-blue-400 hover:bg-neutral-200 dark:hover:bg-neutral-800":"text-neutral-500 dark:text-neutral-400 hover:bg-neutral-200 dark:hover:bg-neutral-800 hover:text-neutral-800 dark:hover:text-neutral-200"]),"aria-label":u.value?"Remove from Read Later":"Save to Read Later"},[(o(),n("svg",{class:"h-5 w-5",fill:u.value?"currentColor":"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[...e[6]||(e[6]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0111.186 0z"},null,-1)])],8,oe))],10,ne)):l("",!0),t.value?(o(),n("button",{key:1,onClick:U,class:"rounded-lg p-2 text-neutral-500 dark:text-neutral-400 hover:bg-neutral-200 dark:hover:bg-neutral-800 hover:text-neutral-800 dark:hover:text-neutral-200 transition-colors cursor-pointer","aria-label":"Share article"},[...e[7]||(e[7]=[a("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7.217 10.907a2.25 2.25 0 100 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186l9.566-5.314m-9.566 7.5l9.566 5.314m0 0a2.25 2.25 0 103.935 2.186 2.25 2.25 0 00-3.935-2.186zm0-12.814a2.25 2.25 0 103.933-2.185 2.25 2.25 0 00-3.933 2.185z"})],-1)])])):l("",!0),t.value?(o(),n("div",{key:2,ref_key:"menuRef",ref:y,class:"relative"},[a("button",{onClick:X,class:"rounded-lg p-2 text-neutral-500 dark:text-neutral-400 hover:bg-neutral-200 dark:hover:bg-neutral-800 hover:text-neutral-800 dark:hover:text-neutral-200 transition-colors cursor-pointer","aria-label":"More actions"},[...e[8]||(e[8]=[a("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.75 12a.75.75 0 11-1.5 0 .75.75 0 011.5 0zM12.75 12a.75.75 0 11-1.5 0 .75.75 0 011.5 0zM18.75 12a.75.75 0 11-1.5 0 .75.75 0 011.5 0z"})],-1)])]),c.value?(o(),n("div",le,[a("button",{onClick:e[0]||(e[0]=s=>H()),class:"flex w-full items-center gap-3 px-4 py-2.5 text-sm text-neutral-700 dark:text-neutral-300 hover:bg-neutral-100 dark:hover:bg-neutral-700 transition-colors cursor-pointer"},[...e[9]||(e[9]=[a("svg",{class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21.75 9v.906a2.25 2.25 0 01-1.183 1.981l-6.478 3.488M2.25 9v.906a2.25 2.25 0 001.183 1.981l6.478 3.488m8.839 2.51l-4.66-2.51m0 0l-1.023-.55a2.25 2.25 0 00-2.134 0l-1.022.55m0 0l-4.661 2.51m16.5 1.615a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V8.844a2.25 2.25 0 011.183-1.98l7.5-4.04a2.25 2.25 0 012.134 0l7.5 4.04a2.25 2.25 0 011.183 1.98V18"})],-1),f(" Mark as unread ",-1)])]),t.value.url?(o(),n("button",{key:0,onClick:e[1]||(e[1]=s=>L()),class:"flex w-full items-center gap-3 px-4 py-2.5 text-sm text-neutral-700 dark:text-neutral-300 hover:bg-neutral-100 dark:hover:bg-neutral-700 transition-colors cursor-pointer"},[...e[10]||(e[10]=[a("svg",{class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"})],-1),f(" Open in browser ",-1)])])):l("",!0)])):l("",!0)],512)):l("",!0)])])]),w.value?(o(),n("div",se,[...e[11]||(e[11]=[a("svg",{class:"h-8 w-8 animate-spin text-neutral-400",fill:"none",viewBox:"0 0 24 24"},[a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)])])):t.value?(o(),n("div",ue,[a("article",{ref_key:"articleEl",ref:_,class:"mx-auto max-w-3xl px-4 py-6",onTouchstartPassive:P,onTouchend:$},[a("header",ie,[a("h1",de,[t.value.url?(o(),n("a",{key:0,href:t.value.url,target:"_blank",rel:"noopener noreferrer",class:"hover:text-blue-500 dark:hover:text-blue-400 transition-colors"},p(t.value.title),9,ce)):(o(),n(E,{key:1},[f(p(t.value.title),1)],64))]),a("div",ve,[t.value.feed_id?(o(),n("a",{key:0,href:"#",class:"flex items-center gap-2 hover:text-blue-500 dark:hover:text-blue-400 transition-colors",onClick:e[2]||(e[2]=J(s=>q(t.value.feed_id),["prevent"]))},[t.value.feed_favicon_url?(o(),n("img",{key:0,src:t.value.feed_favicon_url,class:"h-4 w-4 rounded-sm",alt:""},null,8,pe)):l("",!0),a("span",null,p(t.value.feed_title),1)])):l("",!0),t.value.author?(o(),n("span",ke,"· "+p(t.value.author),1)):l("",!0),a("span",null,"· "+p(N.value)+" at "+p(V.value),1)])]),z.value?(o(),n("img",{key:0,src:t.value.image_url,alt:t.value.title,class:"mb-6 w-full max-h-80 object-cover rounded-lg",loading:"lazy"},null,8,fe)):l("",!0),a("div",{class:"article-content prose max-w-none dark:prose-invert prose-headings:text-neutral-800 dark:prose-headings:text-neutral-200 prose-p:text-neutral-700 dark:prose-p:text-neutral-300 prose-a:text-blue-400 prose-a:no-underline hover:prose-a:underline prose-strong:text-neutral-800 dark:prose-strong:text-neutral-200 prose-code:text-blue-300 prose-pre:bg-neutral-50 dark:prose-pre:bg-neutral-900 prose-pre:border prose-pre:border-neutral-200 dark:prose-pre:border-neutral-800 prose-img:rounded-lg prose-blockquote:border-neutral-300 dark:prose-blockquote:border-neutral-700 prose-blockquote:text-neutral-500 dark:prose-blockquote:text-neutral-400",innerHTML:t.value.content||t.value.summary},null,8,me),!t.value.content&&!t.value.summary?(o(),n("div",he,[e[12]||(e[12]=a("p",{class:"text-neutral-500 dark:text-neutral-400"},"No article content available.",-1)),t.value.url?(o(),n("button",{key:0,onClick:L,class:"mt-4 rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700 transition-colors cursor-pointer"}," Read on original site ")):l("",!0)])):l("",!0),a("div",xe,[h.value.prev?(o(),n("button",{key:0,onClick:e[3]||(e[3]=s=>v("prev")),class:"flex items-center gap-1 text-sm text-neutral-500 hover:text-neutral-800 dark:hover:text-neutral-200 transition-colors cursor-pointer"},[...e[13]||(e[13]=[a("svg",{class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})],-1),f(" Previous ",-1)])])):(o(),n("div",ge)),h.value.next?(o(),n("button",{key:2,onClick:e[4]||(e[4]=s=>v("next")),class:"flex items-center gap-1 text-sm text-neutral-500 hover:text-neutral-800 dark:hover:text-neutral-200 transition-colors cursor-pointer"},[...e[14]||(e[14]=[f(" Next ",-1),a("svg",{class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"})],-1)])])):(o(),n("div",be))])],544)])):l("",!0)],64))}},Se=ee(we,[["__scopeId","data-v-1656ddd3"]]);export{Se as default};
