import{h as o,i as I,m as $,c as s,a as j,u as U,q as O,w as z,d as e,z as E,A as R,o as l,b as u,t as i,F as b,r as A,n as B,e as P,g as _}from"./app-BG7stg-u.js";import{A as G}from"./AppLayout-B3jKJDg1.js";import"./TextInput-D_2ddI9X.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const H={class:"sticky top-14 z-20 border-b border-neutral-200 dark:border-neutral-800 bg-white/95 dark:bg-neutral-950/95 px-4 py-3 backdrop-blur"},J={class:"relative"},K={key:1,class:"absolute right-3 top-1/2 -translate-y-1/2"},Q={key:0,class:"flex flex-col items-center justify-center px-4 py-20 text-center"},W={key:1,class:"flex flex-col items-center justify-center px-4 py-20 text-center"},X={class:"mt-2 text-sm text-neutral-600 dark:text-neutral-500"},Y={key:2},Z={class:"lg:hidden"},ee=["onClick"],te={class:"min-w-0 flex-1"},re={class:"flex items-center gap-2 text-xs text-neutral-600 dark:text-neutral-500"},ae=["src"],se={class:"truncate"},le={class:"shrink-0"},ne={key:0,class:"mt-0.5 line-clamp-2 text-xs text-neutral-600 dark:text-neutral-500"},oe=["src","alt"],ue={class:"hidden lg:block"},ie=["onClick"],de=["src"],ce={class:"w-32 shrink-0 truncate text-xs text-neutral-600 dark:text-neutral-500"},fe={key:1,class:"hidden xl:block w-64 shrink-0 truncate text-xs text-neutral-500 dark:text-neutral-600"},ve={class:"w-12 shrink-0 text-right text-xs text-neutral-500 dark:text-neutral-600"},xe={key:0,class:"text-sm text-neutral-600 dark:text-neutral-500"},he={key:1,class:"py-8 text-center text-sm text-neutral-500 dark:text-neutral-600"},ye={__name:"Search",props:{articles:Object,query:String,feedId:Number,categoryId:Number},setup(N){const n=N,d=o(n.query||""),p=o(!1),k=o(!1),x=o(null),c=o(n.articles?.data?[...n.articles.data]:[]),v=o(n.articles?.next_page_url||null),h=o(!!n.query);I(()=>n.articles,a=>{a&&(c.value=[...a.data],v.value=a.next_page_url)}),I(()=>n.query,a=>{a!==void 0&&(d.value=a||"")});function T(){x.value&&clearTimeout(x.value);const a=d.value.trim();if(!a){c.value=[],v.value=null,h.value=!1;return}p.value=!0,x.value=setTimeout(()=>{q(a)},300)}function q(a){const r={q:a};n.feedId&&(r.feed_id=n.feedId),n.categoryId&&(r.category_id=n.categoryId),_.get(route("articles.search"),r,{preserveState:!0,preserveScroll:!0,onSuccess:()=>{h.value=!0},onFinish:()=>{p.value=!1}})}function w(a){_.visit(route("articles.show",a.id))}function S(a){const r=new Date,t=new Date(a),m=Math.floor((r-t)/1e3);if(m<60)return"just now";const g=Math.floor(m/60);if(g<60)return`${g}m`;const y=Math.floor(g/60);if(y<24)return`${y}h`;const M=Math.floor(y/24);return M<7?`${M}d`:t.toLocaleDateString("en-US",{month:"short",day:"numeric"})}function V(){!v.value||k.value||(k.value=!0,_.get(v.value,{},{preserveState:!0,preserveScroll:!0,only:["articles"],onSuccess:a=>{const r=a.props.articles;c.value.push(...r.data),v.value=r.next_page_url},onFinish:()=>{k.value=!1}}))}const f=o(null);function D(){f.value&&f.value.disconnect(),f.value=new IntersectionObserver(a=>{a[0].isIntersecting&&V()},{rootMargin:"200px"})}function F(a){a?(D(),f.value.observe(a)):f.value&&f.value.disconnect()}const C=o(null);function L(){d.value="",c.value=[],v.value=null,h.value=!1,C.value?.focus()}return $(()=>{f.value&&f.value.disconnect(),x.value&&clearTimeout(x.value)}),(a,r)=>(l(),s(b,null,[j(U(O),{title:"Search"}),j(G,null,{title:z(()=>[...r[1]||(r[1]=[P("Search",-1)])]),default:z(()=>[e("div",H,[e("div",J,[r[4]||(r[4]=e("svg",{class:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-neutral-400 dark:text-neutral-500",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})],-1)),E(e("input",{ref_key:"searchInputRef",ref:C,"onUpdate:modelValue":r[0]||(r[0]=t=>d.value=t),onInput:T,type:"search",placeholder:"Search articles...",class:"w-full rounded-lg border border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-800 py-2.5 pl-10 pr-10 text-base text-neutral-800 dark:text-neutral-100 placeholder-neutral-500 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:ring-offset-0",autocomplete:"off"},null,544),[[R,d.value]]),d.value?(l(),s("button",{key:0,onClick:L,class:"absolute right-3 top-1/2 -translate-y-1/2 rounded p-0.5 text-neutral-400 dark:text-neutral-500 hover:text-neutral-700 dark:hover:text-neutral-300 transition-colors","aria-label":"Clear search"},[...r[2]||(r[2]=[e("svg",{class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)])])):u("",!0),p.value?(l(),s("div",K,[...r[3]||(r[3]=[e("svg",{class:"h-4 w-4 animate-spin text-blue-500",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})],-1)])])):u("",!0)])]),!h.value&&!d.value?(l(),s("div",Q,[...r[5]||(r[5]=[e("svg",{class:"h-16 w-16 text-neutral-300 dark:text-neutral-700",fill:"none",viewBox:"0 0 24 24","stroke-width":"1",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})],-1),e("h3",{class:"mt-4 text-lg font-medium text-neutral-700 dark:text-neutral-300"}," Search your articles ",-1),e("p",{class:"mt-2 text-sm text-neutral-600 dark:text-neutral-500"}," Find articles by title or content across all your feeds. ",-1)])])):h.value&&c.value.length===0&&!p.value?(l(),s("div",W,[r[6]||(r[6]=e("svg",{class:"h-16 w-16 text-neutral-300 dark:text-neutral-700",fill:"none",viewBox:"0 0 24 24","stroke-width":"1",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})],-1)),r[7]||(r[7]=e("h3",{class:"mt-4 text-lg font-medium text-neutral-700 dark:text-neutral-300"}," No results found ",-1)),e("p",X,' No articles match "'+i(d.value)+'". Try different keywords. ',1)])):c.value.length>0?(l(),s("div",Y,[e("div",Z,[(l(!0),s(b,null,A(c.value,t=>(l(),s("div",{key:t.id,class:"border-b border-neutral-200/50 dark:border-neutral-800/50"},[e("button",{onClick:m=>w(t),class:"flex w-full gap-3 px-4 py-3 text-left transition-colors hover:bg-neutral-50 dark:hover:bg-neutral-900/50 active:bg-neutral-100 dark:active:bg-neutral-800/50"},[e("div",te,[e("div",re,[t.feed?.favicon_url?(l(),s("img",{key:0,src:t.feed.favicon_url,class:"h-3.5 w-3.5 rounded-sm",alt:""},null,8,ae)):u("",!0),e("span",se,i(t.feed?.title),1),r[8]||(r[8]=e("span",null,"Â·",-1)),e("span",le,i(S(t.published_at)),1)]),e("h3",{class:B(["mt-1 text-sm leading-snug",t.is_read?"text-neutral-600 dark:text-neutral-500 font-normal":"text-neutral-900 dark:text-neutral-100 font-semibold"])},i(t.title),3),t.summary?(l(),s("p",ne,i(t.summary),1)):u("",!0)]),t.image_url?(l(),s("img",{key:0,src:t.image_url,class:"h-16 w-16 shrink-0 rounded-lg object-cover",alt:t.title,loading:"lazy"},null,8,oe)):u("",!0)],8,ee)]))),128))]),e("div",ue,[(l(!0),s(b,null,A(c.value,t=>(l(),s("button",{key:t.id,onClick:m=>w(t),class:"flex w-full items-center gap-3 border-b border-neutral-200/50 dark:border-neutral-800/50 px-4 py-2.5 text-left transition-colors hover:bg-neutral-50 dark:hover:bg-neutral-900/50 active:bg-neutral-100 dark:active:bg-neutral-800/50"},[t.feed?.favicon_url?(l(),s("img",{key:0,src:t.feed.favicon_url,class:"h-4 w-4 shrink-0 rounded-sm",alt:""},null,8,de)):u("",!0),e("span",ce,i(t.feed?.title),1),e("h3",{class:B(["min-w-0 flex-1 truncate text-sm",t.is_read?"text-neutral-600 dark:text-neutral-500 font-normal":"text-neutral-900 dark:text-neutral-100 font-medium"])},i(t.title),3),t.summary?(l(),s("span",fe,i(t.summary),1)):u("",!0),e("span",ve,i(S(t.published_at)),1)],8,ie))),128))]),v.value?(l(),s("div",{key:0,ref:F,class:"flex justify-center py-6"},[k.value?(l(),s("div",xe," Loading more... ")):u("",!0)])):(l(),s("div",he," End of results "))])):u("",!0)]),_:1})],64))}};export{ye as default};
